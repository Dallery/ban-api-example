<!DOCTYPE html>
<html lang="en">
  <head>
    <base target="_top" />
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Leaflet BAN demo</title>

    <link
      rel="shortcut icon"
      type="image/x-icon"
      href="docs/images/favicon.ico"
    />

    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css"
      integrity="sha256-kLaT2GOSpHechhsozzB+flnD+zUyjE2LlfWPgU04xyI="
      crossorigin=""
    />
    <script
      src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js"
      integrity="sha256-WBkoXOwTeyKclOHuWtc+i2uENFpDZ9YPdf5Hf+D7ewM="
      crossorigin=""
    ></script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/proj4js/2.8.0/proj4.js"
      integrity="sha512-ha3Is9IgbEyIInSb+4S6IlEwpimz00N5J/dVLQFKhePkZ/HywIbxLeEu5w+hRjVBpbujTogNyT311tluwemy9w=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    ></script>
    <script src="https://unpkg.com/@turf/turf@6/turf.min.js"></script>

    <style>
      html,
      body {
        height: 100%;
        margin: 0;
      }
      .leaflet-container {
        height: 600px;
        width: 800px;
        max-width: 100%;
        max-height: 100%;
		position:relative;
      }
      input {
        border: 0 none;
      }

      .search-container {
        width: 400px;
        position: inherit;
        margin: 15px auto;
		
      }
      .search-container input,
      .search-container .suggestions {
        width: 100%;
        background: #fff;
        text-align: left;
      }
      .search-container input {
        background: rgba(255, 255, 255, 0.2);
        height: 60px;
        padding: 0 10px;
		text-align: center;
      }
      .search-container .suggestions {
        /* position: absolute; */
        top: 60px;
		text-align: center;
      }

      ul {
        display: none;
        list-style-type: none;
        padding: 0;
        margin: 0;
        box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.2);
        max-height: 200px;
        overflow-y: auto;
      }
      ul.has-suggestions {
        display: block;
      }
      ul li {
        padding: 10px;
        cursor: pointer;
        background: rgba(255, 255, 255, 0.2);
      }
      ul li:hover {
        background-color: #556bdb;
      }

      input {
        border-bottom: 2px solid #556bdb;
      }
    </style>
  </head>
  <body>
	<div style="position: relative;width: 800px;">
    <div id="map"></div>
    <div class="search-container">
      <input
        type="text"
        id="adresse"
        placeholder="Entrez votre adresse"
        size="70"
      />
      <div class="suggestions">
        <ul></ul>
      </div>
    </div>
</div>

    <script>
      const fromProjection =
        'PROJCS["RGF93 v1 / Lambert-93",GEOGCS["RGF93 v1",DATUM["Reseau_Geodesique_Francais_1993_v1",SPHEROID["GRS 1980",6378137,298.257222101],TOWGS84[0,0,0,0,0,0,0]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],UNIT["degree",0.0174532925199433,AUTHORITY["EPSG","9122"]],AUTHORITY["EPSG","4171"]],PROJECTION["Lambert_Conformal_Conic_2SP"],PARAMETER["latitude_of_origin",46.5],PARAMETER["central_meridian",3],PARAMETER["standard_parallel_1",49],PARAMETER["standard_parallel_2",44],PARAMETER["false_easting",700000],PARAMETER["false_northing",6600000],UNIT["metre",1,AUTHORITY["EPSG","9001"]],AXIS["Easting",EAST],AXIS["Northing",NORTH],AUTHORITY["EPSG","2154"]]';
      const toProjection = "EPSG:4326";
      // carte
      const map = L.map("map", { zoomSnap: 0 });

      // données de la geom
      const vascq_geom = {
        type: "Feature",
        geometry: {
          type: "Polygon",
          coordinates: [
            [
              [3.130381, 50.605667],
              [3.131328, 50.606393],
              [3.131384, 50.606428],
              [3.131514, 50.606517],
              [3.131846, 50.606777],
              [3.130914, 50.607387],
              [3.130617, 50.607581],
              [3.130389, 50.60773],
              [3.130163, 50.607878],
              [3.129553, 50.608277],
              [3.129512, 50.608303],
              [3.129851, 50.608562],
              [3.129925, 50.608616],
              [3.128832, 50.609194],
              [3.128598, 50.609318],
              [3.128271, 50.609489],
              [3.128023, 50.609621],
              [3.127615, 50.609836],
              [3.126437, 50.610459],
              [3.126966, 50.610893],
              [3.127186, 50.611073],
              [3.127069, 50.611128],
              [3.126681, 50.611332],
              [3.126562, 50.611395],
              [3.126216, 50.611578],
              [3.12574, 50.611828],
              [3.125671, 50.611865],
              [3.125939, 50.612051],
              [3.12636, 50.612343],
              [3.1265, 50.61244],
              [3.126756, 50.61262],
              [3.12674, 50.612636],
              [3.126463, 50.612899],
              [3.125909, 50.613425],
              [3.126622, 50.61378],
              [3.12689, 50.613913],
              [3.126667, 50.614121],
              [3.126599, 50.614182],
              [3.126451, 50.614317],
              [3.126412, 50.614355],
              [3.126348, 50.614412],
              [3.126268, 50.614487],
              [3.125279, 50.615397],
              [3.123579, 50.61641],
              [3.123476, 50.616348],
              [3.123392, 50.616299],
              [3.12121, 50.617901],
              [3.120647, 50.618327],
              [3.120597, 50.618341],
              [3.12031, 50.618512],
              [3.120249, 50.618577],
              [3.121631, 50.619327],
              [3.122358, 50.619763],
              [3.122597, 50.619889],
              [3.122661, 50.619901],
              [3.122741, 50.619904],
              [3.122796, 50.619902],
              [3.122843, 50.619889],
              [3.122902, 50.61986],
              [3.123405, 50.6195],
              [3.123478, 50.619446],
              [3.123614, 50.619327],
              [3.124454, 50.618747],
              [3.124605, 50.618834],
              [3.124643, 50.619049],
              [3.124683, 50.6196],
              [3.124672, 50.619762],
              [3.124849, 50.61987],
              [3.12485, 50.619946],
              [3.124873, 50.620062],
              [3.12487, 50.620171],
              [3.12533, 50.62016],
              [3.125649, 50.620154],
              [3.125662, 50.620181],
              [3.125669, 50.620195],
              [3.125652, 50.620264],
              [3.125799, 50.62041],
              [3.126044, 50.62054],
              [3.125647, 50.620452],
              [3.125688, 50.621129],
              [3.12547, 50.621143],
              [3.12474, 50.621565],
              [3.124637, 50.621618],
              [3.124551, 50.621582],
              [3.124478, 50.621621],
              [3.123534, 50.622187],
              [3.123394, 50.622283],
              [3.123213, 50.622377],
              [3.122513, 50.6228],
              [3.122469, 50.622834],
              [3.12237, 50.62288],
              [3.121984, 50.62308],
              [3.122016, 50.623199],
              [3.121987, 50.623202],
              [3.121766, 50.623224],
              [3.121584, 50.623241],
              [3.12154, 50.623252],
              [3.121622, 50.623349],
              [3.121803, 50.623561],
              [3.121874, 50.623645],
              [3.121983, 50.623773],
              [3.122304, 50.624152],
              [3.122311, 50.624159],
              [3.122378, 50.62423],
              [3.123, 50.62491],
              [3.123229, 50.626125],
              [3.123345, 50.6263],
              [3.123455, 50.62634],
              [3.123633, 50.626358],
              [3.123, 50.627158],
              [3.122807, 50.627308],
              [3.121836, 50.627517],
              [3.121878, 50.627759],
              [3.121841, 50.627976],
              [3.121635, 50.628514],
              [3.121227, 50.629584],
              [3.120847, 50.630546],
              [3.120722, 50.631566],
              [3.120927, 50.632846],
              [3.12106, 50.633674],
              [3.12117, 50.634078],
              [3.121329, 50.634526],
              [3.121563, 50.635106],
              [3.120939, 50.635268],
              [3.120855, 50.635289],
              [3.120642, 50.635343],
              [3.12033, 50.635303],
              [3.119629, 50.635052],
              [3.1195, 50.635027],
              [3.119303, 50.635038],
              [3.119122, 50.635094],
              [3.118956, 50.635213],
              [3.118635, 50.635511],
              [3.118449, 50.635661],
              [3.118348, 50.635758],
              [3.118243, 50.635855],
              [3.118121, 50.63597],
              [3.116447, 50.636356],
              [3.116851, 50.636619],
              [3.116898, 50.636651],
              [3.117029, 50.636747],
              [3.117142, 50.636838],
              [3.117204, 50.636906],
              [3.117299, 50.637033],
              [3.117376, 50.63722],
              [3.117401, 50.637321],
              [3.117406, 50.637393],
              [3.1174, 50.637438],
              [3.117395, 50.63747],
              [3.117318, 50.637765],
              [3.117286, 50.637888],
              [3.117263, 50.637997],
              [3.117261, 50.63813],
              [3.117268, 50.638314],
              [3.117304, 50.638507],
              [3.117318, 50.638592],
              [3.117384, 50.638949],
              [3.117391, 50.638988],
              [3.117463, 50.639337],
              [3.117474, 50.639391],
              [3.117534, 50.639597],
              [3.117616, 50.639767],
              [3.11777, 50.639995],
              [3.118001, 50.640281],
              [3.118065, 50.64036],
              [3.118273, 50.640619],
              [3.118281, 50.640631],
              [3.118516, 50.640921],
              [3.118647, 50.641072],
              [3.118713, 50.641139],
              [3.118744, 50.641172],
              [3.118894, 50.641285],
              [3.119174, 50.641475],
              [3.11928, 50.641541],
              [3.119358, 50.641578],
              [3.119447, 50.641608],
              [3.119663, 50.641656],
              [3.11968, 50.641659],
              [3.119965, 50.641903],
              [3.120097, 50.642015],
              [3.120337, 50.642221],
              [3.120341, 50.642224],
              [3.121148, 50.642914],
              [3.121241, 50.642946],
              [3.12244, 50.643373],
              [3.122532, 50.643405],
              [3.122878, 50.643527],
              [3.122747, 50.64366],
              [3.122529, 50.643886],
              [3.122253, 50.644169],
              [3.122167, 50.644256],
              [3.12225, 50.644314],
              [3.122433, 50.644445],
              [3.122522, 50.644508],
              [3.123739, 50.645379],
              [3.123934, 50.645518],
              [3.123995, 50.645705],
              [3.124072, 50.645939],
              [3.124247, 50.646466],
              [3.124316, 50.646568],
              [3.124914, 50.647448],
              [3.124938, 50.647513],
              [3.124846, 50.647672],
              [3.12476, 50.647851],
              [3.124617, 50.648144],
              [3.124496, 50.648374],
              [3.124416, 50.648516],
              [3.124351, 50.6486],
              [3.124333, 50.648622],
              [3.124239, 50.648734],
              [3.124034, 50.648946],
              [3.123867, 50.649111],
              [3.123696, 50.649253],
              [3.12338, 50.649551],
              [3.123075, 50.649848],
              [3.122935, 50.649986],
              [3.122925, 50.649996],
              [3.122874, 50.649964],
              [3.122464, 50.649722],
              [3.122366, 50.64966],
              [3.122061, 50.649486],
              [3.121924, 50.649401],
              [3.121901, 50.649387],
              [3.121776, 50.64932],
              [3.121665, 50.649259],
              [3.121614, 50.649228],
              [3.121453, 50.649135],
              [3.121415, 50.649112],
              [3.12135, 50.649076],
              [3.121335, 50.649066],
              [3.121281, 50.649045],
              [3.121246, 50.649026],
              [3.12084, 50.648795],
              [3.120796, 50.648771],
              [3.120759, 50.648809],
              [3.120641, 50.648938],
              [3.120149, 50.648721],
              [3.120065, 50.648684],
              [3.119453, 50.648412],
              [3.119029, 50.648226],
              [3.118557, 50.648016],
              [3.118179, 50.648294],
              [3.118338, 50.648359],
              [3.118562, 50.648465],
              [3.118796, 50.648566],
              [3.119036, 50.648678],
              [3.119225, 50.648782],
              [3.119484, 50.648934],
              [3.11953, 50.648963],
              [3.119844, 50.649153],
              [3.120051, 50.649272],
              [3.120087, 50.649293],
              [3.120035, 50.649356],
              [3.119913, 50.649504],
              [3.119571, 50.649916],
              [3.119263, 50.650286],
              [3.119217, 50.650272],
              [3.118512, 50.650058],
              [3.118391, 50.650013],
              [3.117856, 50.649845],
              [3.11778, 50.650144],
              [3.117675, 50.650558],
              [3.117616, 50.65079],
              [3.117126, 50.651296],
              [3.116797, 50.651637],
              [3.116687, 50.65175],
              [3.116508, 50.651935],
              [3.116091, 50.652367],
              [3.115946, 50.652517],
              [3.116083, 50.65259],
              [3.116315, 50.652712],
              [3.116158, 50.652898],
              [3.115914, 50.653182],
              [3.11893, 50.653496],
              [3.118941, 50.653473],
              [3.11951, 50.65229],
              [3.119533, 50.652244],
              [3.120383, 50.652346],
              [3.120547, 50.65187],
              [3.120573, 50.651797],
              [3.121172, 50.651915],
              [3.121384, 50.651957],
              [3.121977, 50.652076],
              [3.122547, 50.652329],
              [3.122839, 50.652459],
              [3.123081, 50.652567],
              [3.12337, 50.652696],
              [3.123766, 50.652082],
              [3.123865, 50.65193],
              [3.124431, 50.651051],
              [3.12453, 50.650898],
              [3.124634, 50.650919],
              [3.124838, 50.65095],
              [3.125133, 50.650989],
              [3.125491, 50.651038],
              [3.125914, 50.651109],
              [3.126075, 50.65114],
              [3.126587, 50.651792],
              [3.126688, 50.651919],
              [3.126943, 50.652244],
              [3.127041, 50.652367],
              [3.127085, 50.65243],
              [3.127167, 50.652551],
              [3.127438, 50.652908],
              [3.127494, 50.652983],
              [3.127533, 50.653036],
              [3.127653, 50.653199],
              [3.127677, 50.653237],
              [3.127724, 50.653303],
              [3.127755, 50.65335],
              [3.127798, 50.653413],
              [3.127883, 50.653567],
              [3.127954, 50.653716],
              [3.12802, 50.653897],
              [3.128144, 50.654312],
              [3.128157, 50.654392],
              [3.128149, 50.654427],
              [3.128126, 50.654452],
              [3.128322, 50.654676],
              [3.128484, 50.654858],
              [3.128531, 50.654925],
              [3.12855, 50.654986],
              [3.128553, 50.655061],
              [3.128532, 50.655131],
              [3.128453, 50.6553],
              [3.128432, 50.655328],
              [3.128308, 50.655504],
              [3.128256, 50.655578],
              [3.12811, 50.655783],
              [3.127961, 50.655993],
              [3.128006, 50.656182],
              [3.12802, 50.65634],
              [3.128037, 50.656352],
              [3.128082, 50.656385],
              [3.128256, 50.656618],
              [3.128301, 50.656693],
              [3.128327, 50.656756],
              [3.128333, 50.656835],
              [3.128304, 50.657032],
              [3.12823, 50.65746],
              [3.128179, 50.657814],
              [3.12817, 50.657858],
              [3.128131, 50.658056],
              [3.128077, 50.658235],
              [3.12804, 50.658353],
              [3.127994, 50.658491],
              [3.127963, 50.658618],
              [3.127958, 50.658724],
              [3.127955, 50.658743],
              [3.128339, 50.659397],
              [3.128379, 50.659445],
              [3.12854, 50.659629],
              [3.128726, 50.659773],
              [3.128912, 50.659834],
              [3.129152, 50.659877],
              [3.129364, 50.659858],
              [3.129485, 50.659807],
              [3.130038, 50.659575],
              [3.130143, 50.659536],
              [3.131001, 50.660157],
              [3.132058, 50.660905],
              [3.132846, 50.660532],
              [3.133131, 50.660299],
              [3.133391, 50.660934],
              [3.133649, 50.661356],
              [3.133786, 50.661579],
              [3.134086, 50.661797],
              [3.134251, 50.661804],
              [3.135973, 50.663053],
              [3.135831, 50.663362],
              [3.135802, 50.663424],
              [3.135829, 50.663452],
              [3.135931, 50.663561],
              [3.135955, 50.663587],
              [3.136059, 50.663698],
              [3.136102, 50.663746],
              [3.136422, 50.664079],
              [3.136289, 50.664182],
              [3.136174, 50.664273],
              [3.136193, 50.664451],
              [3.136337, 50.664567],
              [3.136385, 50.664607],
              [3.136941, 50.665056],
              [3.136699, 50.665191],
              [3.136549, 50.665272],
              [3.13637, 50.665372],
              [3.136394, 50.665435],
              [3.136495, 50.665581],
              [3.136674, 50.665794],
              [3.137029, 50.666217],
              [3.137703, 50.667007],
              [3.138297, 50.667826],
              [3.138348, 50.667894],
              [3.13854, 50.668131],
              [3.138673, 50.668271],
              [3.138693, 50.668291],
              [3.138715, 50.668315],
              [3.138601, 50.668442],
              [3.138515, 50.668487],
              [3.138203, 50.668569],
              [3.137821, 50.668683],
              [3.137539, 50.668772],
              [3.137351, 50.668844],
              [3.137188, 50.668893],
              [3.136986, 50.668939],
              [3.136726, 50.669017],
              [3.136483, 50.66908],
              [3.136369, 50.669109],
              [3.136268, 50.669137],
              [3.136058, 50.669279],
              [3.136101, 50.669317],
              [3.136864, 50.669978],
              [3.136157, 50.669981],
              [3.135678, 50.670298],
              [3.135651, 50.670315],
              [3.1358, 50.671258],
              [3.135954, 50.671363],
              [3.136048, 50.671426],
              [3.136079, 50.671509],
              [3.136099, 50.67157],
              [3.136122, 50.671661],
              [3.13614, 50.671725],
              [3.136165, 50.671787],
              [3.136213, 50.671982],
              [3.136277, 50.672179],
              [3.136341, 50.672351],
              [3.136419, 50.672497],
              [3.136486, 50.672554],
              [3.136542, 50.672584],
              [3.136574, 50.672609],
              [3.136636, 50.672653],
              [3.136706, 50.672682],
              [3.136784, 50.672698],
              [3.136849, 50.672723],
              [3.136931, 50.67275],
              [3.137002, 50.67279],
              [3.13706, 50.67281],
              [3.137148, 50.672856],
              [3.137211, 50.672908],
              [3.137272, 50.672945],
              [3.137344, 50.672971],
              [3.137404, 50.67299],
              [3.137484, 50.672997],
              [3.137541, 50.672998],
              [3.137567, 50.673036],
              [3.137585, 50.673084],
              [3.137589, 50.673137],
              [3.137646, 50.673211],
              [3.137688, 50.673222],
              [3.13773, 50.673232],
              [3.137762, 50.673252],
              [3.137796, 50.673285],
              [3.137846, 50.673325],
              [3.137969, 50.673383],
              [3.138207, 50.673104],
              [3.138399, 50.672939],
              [3.139147, 50.672631],
              [3.139729, 50.672437],
              [3.141005, 50.671994],
              [3.141641, 50.671765],
              [3.141982, 50.671699],
              [3.142381, 50.671711],
              [3.143167, 50.671754],
              [3.143985, 50.671812],
              [3.144505, 50.671872],
              [3.144739, 50.671874],
              [3.144864, 50.671877],
              [3.14482, 50.671776],
              [3.14479, 50.671703],
              [3.144682, 50.671444],
              [3.145171, 50.671371],
              [3.146247, 50.671214],
              [3.146292, 50.671206],
              [3.147064, 50.671091],
              [3.147773, 50.670988],
              [3.148097, 50.670941],
              [3.148412, 50.670894],
              [3.148543, 50.670874],
              [3.148401, 50.670391],
              [3.148555, 50.669841],
              [3.147962, 50.669596],
              [3.147623, 50.669456],
              [3.14762, 50.669453],
              [3.147419, 50.66927],
              [3.1473, 50.668669],
              [3.147048, 50.668362],
              [3.14683, 50.668099],
              [3.14682, 50.668056],
              [3.146775, 50.667883],
              [3.146662, 50.667442],
              [3.146508, 50.666834],
              [3.14643, 50.666582],
              [3.146392, 50.666357],
              [3.146378, 50.666214],
              [3.146379, 50.666077],
              [3.1464, 50.665971],
              [3.146437, 50.665843],
              [3.146484, 50.665673],
              [3.146505, 50.665599],
              [3.14649, 50.665563],
              [3.146451, 50.665495],
              [3.146366, 50.665429],
              [3.146045, 50.665224],
              [3.145937, 50.665153],
              [3.145919, 50.665142],
              [3.146105, 50.665028],
              [3.146213, 50.664946],
              [3.146264, 50.664908],
              [3.146415, 50.664794],
              [3.14643, 50.664782],
              [3.146529, 50.664707],
              [3.146608, 50.664649],
              [3.14666, 50.664608],
              [3.146722, 50.664562],
              [3.146875, 50.664455],
              [3.146984, 50.664384],
              [3.147272, 50.664294],
              [3.147774, 50.664152],
              [3.147963, 50.664098],
              [3.148197, 50.664054],
              [3.148471, 50.66405],
              [3.148763, 50.664078],
              [3.148865, 50.66408],
              [3.148948, 50.664063],
              [3.149102, 50.663952],
              [3.149262, 50.663792],
              [3.149428, 50.663778],
              [3.149627, 50.66377],
              [3.149769, 50.663692],
              [3.149932, 50.663564],
              [3.150181, 50.66349],
              [3.150737, 50.663445],
              [3.1513, 50.663378],
              [3.151572, 50.663272],
              [3.151805, 50.66327],
              [3.15208, 50.66317],
              [3.152375, 50.663133],
              [3.15274, 50.663059],
              [3.153258, 50.663008],
              [3.153606, 50.662964],
              [3.153884, 50.662958],
              [3.154122, 50.662941],
              [3.154482, 50.662816],
              [3.154658, 50.662756],
              [3.154904, 50.662705],
              [3.155296, 50.662572],
              [3.155791, 50.662393],
              [3.156187, 50.662216],
              [3.156239, 50.662193],
              [3.156432, 50.662132],
              [3.156617, 50.6621],
              [3.156924, 50.662082],
              [3.157315, 50.66207],
              [3.157574, 50.662015],
              [3.15805, 50.661818],
              [3.158428, 50.661705],
              [3.158563, 50.661612],
              [3.158636, 50.661451],
              [3.158678, 50.661326],
              [3.158643, 50.661058],
              [3.158576, 50.660828],
              [3.158506, 50.660567],
              [3.158552, 50.660441],
              [3.158673, 50.660302],
              [3.158804, 50.660187],
              [3.159126, 50.659906],
              [3.159336, 50.659762],
              [3.159387, 50.659696],
              [3.159505, 50.659541],
              [3.159716, 50.65931],
              [3.160313, 50.658707],
              [3.160686, 50.65833],
              [3.160833, 50.65815],
              [3.160954, 50.658034],
              [3.161333, 50.65767],
              [3.161593, 50.657387],
              [3.161635, 50.657299],
              [3.161721, 50.657119],
              [3.161935, 50.656963],
              [3.162079, 50.656749],
              [3.162219, 50.656608],
              [3.162331, 50.656494],
              [3.162416, 50.656416],
              [3.162526, 50.656345],
              [3.162695, 50.656272],
              [3.162771, 50.65624],
              [3.162848, 50.656159],
              [3.162917, 50.656034],
              [3.162908, 50.655926],
              [3.162925, 50.655781],
              [3.163006, 50.655719],
              [3.163171, 50.655664],
              [3.163223, 50.65556],
              [3.163204, 50.6554],
              [3.163104, 50.655282],
              [3.163068, 50.655156],
              [3.163112, 50.655035],
              [3.163302, 50.654886],
              [3.163745, 50.654571],
              [3.163907, 50.654451],
              [3.164059, 50.65434],
              [3.164234, 50.654305],
              [3.164589, 50.654309],
              [3.164683, 50.654296],
              [3.164799, 50.654272],
              [3.164896, 50.654194],
              [3.165065, 50.653964],
              [3.165136, 50.653874],
              [3.165221, 50.653812],
              [3.165422, 50.653703],
              [3.16559, 50.65364],
              [3.165694, 50.653627],
              [3.165848, 50.653626],
              [3.165985, 50.653631],
              [3.16609, 50.653621],
              [3.166245, 50.653594],
              [3.167526, 50.65309],
              [3.167728, 50.653019],
              [3.16798, 50.652952],
              [3.168014, 50.652943],
              [3.168234, 50.65289],
              [3.16843, 50.652841],
              [3.168626, 50.652793],
              [3.168813, 50.652791],
              [3.169064, 50.65281],
              [3.16965, 50.652935],
              [3.169765, 50.652943],
              [3.169862, 50.652899],
              [3.169993, 50.652856],
              [3.170242, 50.652871],
              [3.170391, 50.652879],
              [3.170458, 50.652913],
              [3.170516, 50.652979],
              [3.170697, 50.653186],
              [3.170914, 50.653461],
              [3.170981, 50.653538],
              [3.171152, 50.653691],
              [3.171227, 50.653772],
              [3.171278, 50.653878],
              [3.171357, 50.654069],
              [3.171414, 50.654229],
              [3.171559, 50.654295],
              [3.17164, 50.654295],
              [3.171875, 50.654289],
              [3.172011, 50.654286],
              [3.17223, 50.654234],
              [3.172489, 50.654143],
              [3.1727, 50.654083],
              [3.172981, 50.654088],
              [3.17336, 50.654094],
              [3.173594, 50.654092],
              [3.173773, 50.654078],
              [3.173941, 50.654045],
              [3.17417, 50.653965],
              [3.174601, 50.653827],
              [3.174769, 50.653843],
              [3.174995, 50.653842],
              [3.175088, 50.653851],
              [3.175282, 50.653907],
              [3.175385, 50.653934],
              [3.175478, 50.653936],
              [3.175638, 50.653943],
              [3.176201, 50.654078],
              [3.176369, 50.654122],
              [3.176601, 50.654206],
              [3.176733, 50.654267],
              [3.176815, 50.65429],
              [3.176987, 50.654316],
              [3.177412, 50.654301],
              [3.177508, 50.654279],
              [3.177701, 50.654221],
              [3.177952, 50.654205],
              [3.178027, 50.654191],
              [3.178106, 50.654156],
              [3.178228, 50.654078],
              [3.178317, 50.654054],
              [3.178485, 50.65403],
              [3.178575, 50.653999],
              [3.17877, 50.653949],
              [3.178911, 50.653938],
              [3.179052, 50.653874],
              [3.179085, 50.653865],
              [3.179306, 50.653802],
              [3.179748, 50.653516],
              [3.180496, 50.652996],
              [3.180578, 50.652939],
              [3.180625, 50.652861],
              [3.180649, 50.652734],
              [3.18073, 50.652565],
              [3.180751, 50.652522],
              [3.18071, 50.652397],
              [3.180605, 50.652262],
              [3.180569, 50.652166],
              [3.180567, 50.652097],
              [3.180652, 50.651925],
              [3.180678, 50.651852],
              [3.180676, 50.651761],
              [3.180656, 50.651681],
              [3.180611, 50.651574],
              [3.180605, 50.651509],
              [3.180616, 50.651414],
              [3.180689, 50.651295],
              [3.180734, 50.651214],
              [3.18072, 50.651082],
              [3.180724, 50.650929],
              [3.180752, 50.650868],
              [3.180843, 50.650702],
              [3.180877, 50.650617],
              [3.180871, 50.650521],
              [3.180799, 50.650407],
              [3.180623, 50.650214],
              [3.180466, 50.650084],
              [3.180437, 50.650007],
              [3.180407, 50.649742],
              [3.180407, 50.6496],
              [3.180669, 50.649338],
              [3.180917, 50.649114],
              [3.181102, 50.648808],
              [3.181148, 50.648648],
              [3.181174, 50.648555],
              [3.181217, 50.648341],
              [3.181235, 50.648252],
              [3.181285, 50.647999],
              [3.181397, 50.647754],
              [3.181427, 50.647464],
              [3.181494, 50.647302],
              [3.181645, 50.647041],
              [3.181683, 50.646783],
              [3.181733, 50.64646],
              [3.181762, 50.646277],
              [3.181916, 50.645672],
              [3.182099, 50.645124],
              [3.182191, 50.644831],
              [3.182234, 50.644536],
              [3.182334, 50.644389],
              [3.182509, 50.644186],
              [3.182617, 50.644044],
              [3.182789, 50.643811],
              [3.182984, 50.643578],
              [3.183181, 50.64343],
              [3.183312, 50.643387],
              [3.183487, 50.643321],
              [3.183549, 50.643278],
              [3.183547, 50.64319],
              [3.183547, 50.643166],
              [3.183473, 50.642964],
              [3.18347, 50.64296],
              [3.183369, 50.642797],
              [3.183273, 50.642587],
              [3.183242, 50.642412],
              [3.183183, 50.642303],
              [3.18289, 50.642075],
              [3.182936, 50.642046],
              [3.183444, 50.641727],
              [3.183632, 50.64161],
              [3.184727, 50.640924],
              [3.185452, 50.640469],
              [3.186055, 50.640091],
              [3.185441, 50.639736],
              [3.18668, 50.638919],
              [3.186738, 50.638882],
              [3.186483, 50.63869],
              [3.185889, 50.638241],
              [3.185304, 50.63732],
              [3.185158, 50.637089],
              [3.185121, 50.637112],
              [3.185079, 50.637125],
              [3.185024, 50.63713],
              [3.184945, 50.637117],
              [3.184126, 50.636751],
              [3.184054, 50.636712],
              [3.18392, 50.636722],
              [3.183714, 50.636741],
              [3.183312, 50.636765],
              [3.183124, 50.636768],
              [3.182999, 50.636749],
              [3.182952, 50.636722],
              [3.182876, 50.636713],
              [3.182705, 50.636729],
              [3.182574, 50.636768],
              [3.182459, 50.636824],
              [3.182354, 50.636881],
              [3.182274, 50.636928],
              [3.182219, 50.636949],
              [3.182144, 50.636942],
              [3.181265, 50.636466],
              [3.18119, 50.636427],
              [3.181115, 50.636393],
              [3.180793, 50.636235],
              [3.180702, 50.636184],
              [3.180094, 50.635816],
              [3.180092, 50.63578],
              [3.179258, 50.63534],
              [3.178685, 50.635114],
              [3.178072, 50.634781],
              [3.177744, 50.634604],
              [3.176759, 50.634073],
              [3.177771, 50.633647],
              [3.177871, 50.633604],
              [3.178103, 50.633455],
              [3.179341, 50.632873],
              [3.181913, 50.631663],
              [3.182622, 50.631345],
              [3.183102, 50.6311],
              [3.183749, 50.630792],
              [3.184214, 50.630568],
              [3.184346, 50.630503],
              [3.184842, 50.630239],
              [3.184961, 50.630173],
              [3.185415, 50.629966],
              [3.186197, 50.629565],
              [3.186374, 50.629496],
              [3.186454, 50.629471],
              [3.186531, 50.62946],
              [3.186669, 50.629445],
              [3.186615, 50.629393],
              [3.186589, 50.629368],
              [3.186567, 50.629338],
              [3.18647, 50.629216],
              [3.186263, 50.628944],
              [3.186102, 50.628694],
              [3.185838, 50.628286],
              [3.185808, 50.628228],
              [3.18684, 50.628192],
              [3.186703, 50.627632],
              [3.18666, 50.627463],
              [3.186626, 50.627325],
              [3.186543, 50.626989],
              [3.186495, 50.626706],
              [3.187152, 50.626629],
              [3.187219, 50.626701],
              [3.187495, 50.626702],
              [3.187762, 50.6267],
              [3.188322, 50.626632],
              [3.188759, 50.626596],
              [3.189166, 50.626525],
              [3.190521, 50.62622],
              [3.190641, 50.626193],
              [3.190736, 50.626384],
              [3.190834, 50.626581],
              [3.190737, 50.627307],
              [3.190883, 50.62759],
              [3.190957, 50.6277],
              [3.191249, 50.628142],
              [3.191001, 50.628241],
              [3.190849, 50.628324],
              [3.190725, 50.628404],
              [3.190419, 50.628605],
              [3.190283, 50.628669],
              [3.189903, 50.628837],
              [3.189388, 50.629066],
              [3.188878, 50.62929],
              [3.188538, 50.629452],
              [3.18846, 50.629597],
              [3.188853, 50.629572],
              [3.189848, 50.629522],
              [3.190168, 50.6295],
              [3.190343, 50.629479],
              [3.190528, 50.629445],
              [3.191015, 50.629283],
              [3.191245, 50.629183],
              [3.191849, 50.628932],
              [3.19202, 50.629017],
              [3.192896, 50.629397],
              [3.193764, 50.629006],
              [3.194122, 50.629245],
              [3.194616, 50.628824],
              [3.194832, 50.628664],
              [3.194953, 50.628565],
              [3.195357, 50.628233],
              [3.195588, 50.628042],
              [3.195704, 50.627947],
              [3.196033, 50.628061],
              [3.196112, 50.627989],
              [3.19625, 50.627818],
              [3.196488, 50.627385],
              [3.196533, 50.62817],
              [3.196553, 50.628929],
              [3.196558, 50.629132],
              [3.196589, 50.630077],
              [3.196589, 50.630117],
              [3.196619, 50.63092],
              [3.196636, 50.631396],
              [3.196665, 50.632363],
              [3.196673, 50.632595],
              [3.196703, 50.63415],
              [3.196727, 50.634763],
              [3.198178, 50.634889],
              [3.198421, 50.634914],
              [3.198524, 50.634935],
              [3.198865, 50.63506],
              [3.198971, 50.635098],
              [3.199581, 50.6353],
              [3.199647, 50.635304],
              [3.199707, 50.635306],
              [3.199818, 50.635294],
              [3.200247, 50.635216],
              [3.200695, 50.635088],
              [3.20098, 50.634992],
              [3.201304, 50.634838],
              [3.201502, 50.634733],
              [3.202116, 50.634413],
              [3.203069, 50.633762],
              [3.203126, 50.633714],
              [3.2033, 50.633623],
              [3.203349, 50.633598],
              [3.203562, 50.63351],
              [3.203774, 50.633436],
              [3.204052, 50.633351],
              [3.204263, 50.633549],
              [3.204697, 50.633858],
              [3.205198, 50.634137],
              [3.205283, 50.634294],
              [3.205604, 50.634443],
              [3.205869, 50.634689],
              [3.206047, 50.634808],
              [3.206097, 50.634782],
              [3.206171, 50.634752],
              [3.206668, 50.634625],
              [3.206776, 50.634611],
              [3.206981, 50.634627],
              [3.207088, 50.634626],
              [3.207158, 50.634574],
              [3.20724, 50.634404],
              [3.207286, 50.634349],
              [3.207321, 50.634284],
              [3.207354, 50.634203],
              [3.207389, 50.634128],
              [3.207417, 50.634073],
              [3.207419, 50.634039],
              [3.207387, 50.633997],
              [3.207386, 50.633943],
              [3.207394, 50.633878],
              [3.207605, 50.633359],
              [3.207837, 50.63279],
              [3.207751, 50.632758],
              [3.207547, 50.632741],
              [3.207449, 50.632737],
              [3.207435, 50.632117],
              [3.207406, 50.630851],
              [3.207404, 50.630717],
              [3.20731, 50.628592],
              [3.20726, 50.627753],
              [3.2072, 50.627587],
              [3.207195, 50.626008],
              [3.204491, 50.624376],
              [3.203846, 50.62398],
              [3.202662, 50.625035],
              [3.202553, 50.625135],
              [3.202399, 50.625271],
              [3.201549, 50.625979],
              [3.201304, 50.626159],
              [3.201321, 50.626173],
              [3.201352, 50.626233],
              [3.201381, 50.626279],
              [3.201408, 50.626324],
              [3.201504, 50.626418],
              [3.201736, 50.626654],
              [3.201753, 50.626691],
              [3.201843, 50.626766],
              [3.201869, 50.626788],
              [3.201911, 50.62685],
              [3.201965, 50.626939],
              [3.202035, 50.627139],
              [3.202081, 50.627208],
              [3.202226, 50.627454],
              [3.202373, 50.627686],
              [3.202411, 50.627779],
              [3.202411, 50.627816],
              [3.202404, 50.62785],
              [3.202353, 50.627993],
              [3.202351, 50.628041],
              [3.202345, 50.628107],
              [3.202383, 50.628303],
              [3.202389, 50.628393],
              [3.202341, 50.628866],
              [3.202286, 50.629289],
              [3.202271, 50.629713],
              [3.202247, 50.629827],
              [3.202237, 50.629856],
              [3.202223, 50.629884],
              [3.202207, 50.629909],
              [3.202187, 50.629931],
              [3.202143, 50.629971],
              [3.202074, 50.630007],
              [3.202011, 50.630033],
              [3.201774, 50.630064],
              [3.201412, 50.62959],
              [3.200506, 50.628496],
              [3.20019, 50.628143],
              [3.199412, 50.628528],
              [3.199046, 50.628065],
              [3.199175, 50.62756],
              [3.19908, 50.627183],
              [3.19922, 50.627063],
              [3.199758, 50.626594],
              [3.199081, 50.626624],
              [3.199029, 50.626753],
              [3.198922, 50.627032],
              [3.198201, 50.627058],
              [3.198293, 50.626731],
              [3.197898, 50.62679],
              [3.196987, 50.626931],
              [3.196716, 50.626966],
              [3.196691, 50.627012],
              [3.196503, 50.627018],
              [3.196265, 50.627028],
              [3.196189, 50.627028],
              [3.196118, 50.627019],
              [3.196048, 50.626978],
              [3.195988, 50.626931],
              [3.195917, 50.626829],
              [3.195791, 50.626621],
              [3.19571, 50.626509],
              [3.195704, 50.626477],
              [3.195588, 50.626431],
              [3.195333, 50.626414],
              [3.195275, 50.626299],
              [3.195202, 50.626202],
              [3.195068, 50.626051],
              [3.194905, 50.625877],
              [3.194854, 50.625811],
              [3.194485, 50.625383],
              [3.194332, 50.625203],
              [3.194307, 50.625173],
              [3.19428, 50.625116],
              [3.194215, 50.624905],
              [3.193642, 50.624525],
              [3.193523, 50.624388],
              [3.193413, 50.624258],
              [3.193222, 50.624035],
              [3.193013, 50.624153],
              [3.192929, 50.624204],
              [3.192647, 50.624364],
              [3.192571, 50.62429],
              [3.191929, 50.623596],
              [3.191545, 50.623176],
              [3.191062, 50.623342],
              [3.190845, 50.623057],
              [3.190391, 50.62318],
              [3.190061, 50.623269],
              [3.189889, 50.623316],
              [3.189775, 50.623255],
              [3.189648, 50.62331],
              [3.188933, 50.622586],
              [3.188846, 50.622611],
              [3.188179, 50.622812],
              [3.188089, 50.622847],
              [3.187212, 50.621947],
              [3.186595, 50.621331],
              [3.186494, 50.621258],
              [3.186281, 50.621162],
              [3.185925, 50.62102],
              [3.18547, 50.620924],
              [3.185216, 50.620907],
              [3.18506, 50.620863],
              [3.184996, 50.620824],
              [3.184903, 50.620765],
              [3.184894, 50.620758],
              [3.184157, 50.620167],
              [3.184227, 50.620067],
              [3.184109, 50.620005],
              [3.183778, 50.619835],
              [3.18303, 50.619446],
              [3.18289, 50.619582],
              [3.182791, 50.619528],
              [3.182619, 50.619125],
              [3.182051, 50.618868],
              [3.180575, 50.618218],
              [3.180111, 50.618552],
              [3.179795, 50.618385],
              [3.179587, 50.618276],
              [3.178896, 50.618503],
              [3.178125, 50.618194],
              [3.177208, 50.617845],
              [3.177488, 50.617609],
              [3.175656, 50.61687],
              [3.175683, 50.616822],
              [3.175765, 50.616594],
              [3.175836, 50.616397],
              [3.175877, 50.616325],
              [3.175892, 50.616223],
              [3.176004, 50.615891],
              [3.176012, 50.615862],
              [3.17616, 50.615436],
              [3.176255, 50.615156],
              [3.17649, 50.613631],
              [3.176497, 50.613371],
              [3.176542, 50.611653],
              [3.176907, 50.611508],
              [3.176628, 50.611263],
              [3.176622, 50.611257],
              [3.175609, 50.611063],
              [3.175615, 50.611039],
              [3.175942, 50.61063],
              [3.176303, 50.6102],
              [3.176876, 50.609519],
              [3.177226, 50.609137],
              [3.177506, 50.609168],
              [3.177861, 50.609204],
              [3.178253, 50.609235],
              [3.178789, 50.60927],
              [3.178931, 50.609279],
              [3.179204, 50.609296],
              [3.179302, 50.6093],
              [3.179152, 50.609181],
              [3.179072, 50.609115],
              [3.178956, 50.609024],
              [3.178937, 50.608971],
              [3.178824, 50.608852],
              [3.17848, 50.60852],
              [3.178221, 50.608281],
              [3.178015, 50.60811],
              [3.177549, 50.607767],
              [3.177166, 50.607471],
              [3.177577, 50.607321],
              [3.178568, 50.606941],
              [3.179028, 50.606755],
              [3.178674, 50.606413],
              [3.177784, 50.605619],
              [3.177066, 50.604957],
              [3.176825, 50.605099],
              [3.175287, 50.604103],
              [3.173749, 50.603106],
              [3.172212, 50.60211],
              [3.172134, 50.602126],
              [3.172055, 50.602155],
              [3.171363, 50.602557],
              [3.1707, 50.602947],
              [3.170345, 50.602752],
              [3.169636, 50.602331],
              [3.169318, 50.602144],
              [3.167888, 50.601337],
              [3.167577, 50.60114],
              [3.167418, 50.601033],
              [3.165882, 50.601914],
              [3.16527, 50.601508],
              [3.165102, 50.601398],
              [3.16479, 50.60119],
              [3.163694, 50.600466],
              [3.161292, 50.601995],
              [3.160001, 50.601334],
              [3.159762, 50.601495],
              [3.158137, 50.602588],
              [3.158093, 50.602618],
              [3.156534, 50.603613],
              [3.154475, 50.603989],
              [3.152503, 50.603037],
              [3.15053, 50.602085],
              [3.14856, 50.601134],
              [3.147707, 50.600499],
              [3.147467, 50.600697],
              [3.145822, 50.599183],
              [3.145716, 50.599086],
              [3.145487, 50.599167],
              [3.14517, 50.59928],
              [3.14511, 50.599302],
              [3.144965, 50.599353],
              [3.144335, 50.599576],
              [3.143244, 50.600052],
              [3.142958, 50.600176],
              [3.142859, 50.60022],
              [3.141686, 50.600628],
              [3.141081, 50.600837],
              [3.140745, 50.600954],
              [3.140377, 50.601082],
              [3.139594, 50.601355],
              [3.139449, 50.601429],
              [3.139161, 50.601576],
              [3.139129, 50.601594],
              [3.138906, 50.601709],
              [3.13862, 50.601537],
              [3.13851, 50.601472],
              [3.138035, 50.601193],
              [3.137842, 50.601323],
              [3.137751, 50.601389],
              [3.137107, 50.60185],
              [3.137069, 50.601878],
              [3.136857, 50.602029],
              [3.136592, 50.602219],
              [3.136242, 50.602466],
              [3.136105, 50.602566],
              [3.135728, 50.60284],
              [3.135621, 50.602914],
              [3.135555, 50.602961],
              [3.135475, 50.603015],
              [3.135302, 50.603141],
              [3.135112, 50.603288],
              [3.134902, 50.603424],
              [3.134672, 50.60357],
              [3.134598, 50.603619],
              [3.134292, 50.603798],
              [3.133971, 50.603985],
              [3.133754, 50.604096],
              [3.133612, 50.604169],
              [3.133571, 50.60419],
              [3.133098, 50.604413],
              [3.132525, 50.604672],
              [3.132261, 50.604782],
              [3.131746, 50.605054],
              [3.131681, 50.605079],
              [3.131552, 50.605134],
              [3.131329, 50.60523],
              [3.130936, 50.605398],
              [3.130381, 50.605667],
            ],
          ],
        },
      };

      // style de la geom
      const vascq_style = {
        weight: 3,
        color: "#000000",
        opacity: 1,
        fillColor: "#000000",
        fillOpacity: 0,
      };

      // fond openstreetmap
      const tiles = L.tileLayer(
        "https://tile.openstreetmap.org/{z}/{x}/{y}.png",
        {
          maxZoom: 19,
          attribution:
            '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>',
        }
      ).addTo(map);

      // Charge la geom de villeneuve d'ascq sur la carte
      const vascq_layer = L.geoJSON(vascq_geom, { style: vascq_style }).addTo(
        map
      );
      // Définie la vue selon l'emprise de la geom de villeneuve d'ascq
      map.fitBounds(vascq_layer.getBounds());

      const btn = document.getElementById("btn");

      //marker
      let marker = L.marker(map.getCenter());
      let counter = 0;
      var searchtimer;

      const inputElement = document.querySelector("input");
      const resultsElement = document.querySelector(".suggestions ul");

      inputElement.addEventListener("input", (event) => {
        // Utilisez setTimeout pour déclencher une action après un délai de 500 millisecondes
        clearTimeout(searchtimer);
        searchtimer = setTimeout(() => {
          //if (counter === 1) {
          console.log("Requête à la BAN");
          // Créez un nouvel objet URLSearchParams
          const params = new URLSearchParams();
          const inputElement = document.querySelector("input");
          // Ajoutez les différents paramètres à l'objet
          params.append(
            "q",
            `${inputElement.value},59650 Villeneuve-d'Ascq`.toLowerCase()
          );
          params.append("limit", 5);

          // Créez une nouvelle URL en ajoutant les paramètres à l'URL de base de l'API
          const apiUrl = `https://api-adresse.data.gouv.fr/search/?${params.toString()}`;
          // Envoyez une requête GET à l'API en utilisant l'URL créée
          fetch(apiUrl)
            .then((response) => response.json())
            .then((data) => {
              let results = [];
              data.features.map((result) =>
                results.push(result.properties.label)
              );
			  resultsElement.innerHTML = "";
              if (results.length > 0) {
                for (i = 0; i < results.length; i++) {
                  let item = results[i];
                  // Highlights only the first match
                  // TODO: highlight all matches
                  resultsElement.innerHTML += `<li>${item}</li>`;
                }
                resultsElement.classList.add("has-suggestions");
              } else {
                results = [];
                resultsElement.innerHTML = "";
                resultsElement.classList.remove("has-suggestions");
              }
            });
        }, 1000);
      });

      resultsElement.addEventListener("click", (event) => {
        inputElement.value = event.target.innerText;
        inputElement.focus();
        resultsElement.innerHTML = "";
        resultsElement.classList.remove("has-suggestions");
        //if (counter === 1) {
        console.log("Requête à la BAN");
        // Créez un nouvel objet URLSearchParams
        const params = new URLSearchParams();
        // Ajoutez les différents paramètres à l'objet
        params.append("q", `${inputElement.value},59650 Villeneuve-d'Ascq`);
        params.append("limit", 1);

        // Créez une nouvelle URL en ajoutant les paramètres à l'URL de base de l'API
        const apiUrl = `https://api-adresse.data.gouv.fr/search/?${params.toString()}`;
        // Envoyez une requête GET à l'API en utilisant l'URL créée
        fetch(apiUrl)
          .then((response) => response.json())
          .then((data) => {
            // Traite la réponse de l'API
            let x = data.features[0].properties.x;
            let y = data.features[0].properties.y;
            let coords = proj4(fromProjection, toProjection, [x, y]);
            let latLng = new L.latLng([coords[1], coords[0]]);
            if (
              turf.booleanContains(
                vascq_geom,
                turf.point([coords[0], coords[1]])
              )
            ) {
              console.log("le point est dans la ville");
              marker.setLatLng(latLng).addTo(map);
              map.setView(latLng, 18);
            } else {
              alert("Votre adresse ne se situe pas sur Villeneuve-d'Ascq");
              //marker.setLatLng(latLng).addTo(map);
              //map.setView(latLng, 18);
            }
          })
          .catch((error) => {
            // Gérez les erreurs ici
          });
      });
    </script>
  </body>
</html>
